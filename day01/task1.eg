# Advent of Code (AoC) - day 1, task 1

import "prelude.eg"
import "os.ego"

using System
using OS
using List

def input =
    let L = read_line stdin in
    if eof stdin then {} else {L | input}

def sums =
    [ {none} -> {} | {X} -> {X}
    | {X,none|XX} -> {X|sums XX}
    | {X,Y|XX} -> sums {X+Y|XX} ]

def main =
    let II = map [ "" -> none | N -> to_int N ] input in foldr max 0 (sums II)
